# 主题切换思路以及注意事项

## 思路
在项目发布到NPM库之后，可以使用NPM提供的 [unpkg CDN](https://unpkg.com/#/)下载到对应版本的CSS文件，利用这个CSS文件可实现官网预览以及主题下载等功能

通过XHR获取CSS文本示例
```JS
const xhr = new XMLHttpRequest();
xhr.open('get', 'https://unpkg.com/files-cdn-base@1.0.0/css/app.css');
xhr.onreadystatechange = () => {
  if (xhr.readyState === 4) {
    if (xhr.status === 200) {
      this.originCss = xhr.responseText;
    }
  }
};
xhr.send();
```

官网预览：在用户使用颜色拾取器切换颜色后，将色值与下载的CSS文本中对应色值文字替换，创建一个style标签，将替换后的CSS文本写入，最终appendChild到head标签中，即可实现官网主题色的切换功能。

主题下载：参照[element ui](https://github.com/ElementUI/theme-chalk-preview/blob/master/src/App.vue)的做法，利用[file-saver](https://www.npmjs.com/package/file-saver)以及[jszip](https://www.npmjs.com/package/jszip)即可实现保存定制的主题文件到本地。

## 注意事项

### 主题版本需一致
下载的主题版本需要统一，可以参照element UI的做法，在组件入口文件定义一个版本号，组件库全局使用到的版本号从这个文件获取，每次发布自动或手动修改这个入口文件中的版本号

### 色值需统一
common.scss文件中定义了公共颜色变量，在开发时需要统一使用这些变量

### 删除字体文件引入路径
append到head中的style标签中，不能带有@font-face等定义，以免路径不一致导致404错误

### 内联样式
不能在内联样式中定义色值，不然权重太高而导致无法改变颜色

## 目前存在的问题
* 项目没有发布到npm，没有一个地址可供现在当前版本CSS文件
* 打包官网文件以及组件库文件应该分离
* 打包后文件名不应该带有hash值
* 颜色拾取器不够完善，没有确认选取按钮，在点击取色板后后会直接修改主题色
* 部分组件没有使用common.scss文件中定义的公共颜色变量
